cmake_minimum_required(VERSION 3.16)
project(VehicleControlECU_Mock VERSION 1.0 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_AUTOMOC ON)

message(STATUS "Building VehicleControlECU Mock (PC Test - No Hardware)")

# Qt5
find_package(Qt5 REQUIRED COMPONENTS Core)

# CommonAPI
find_package(CommonAPI 3.2.0 REQUIRED)
find_package(CommonAPI-SomeIP 3.2.0 REQUIRED)
find_package(vsomeip3 REQUIRED)

# Generated CommonAPI code paths
set(COMMONAPI_GEN_DIR ${CMAKE_SOURCE_DIR}/../../../commonapi/generated)
set(COMMONAPI_CORE_DIR ${COMMONAPI_GEN_DIR}/core)
set(COMMONAPI_SOMEIP_DIR ${COMMONAPI_GEN_DIR}/someip)

include_directories(
    ${CMAKE_SOURCE_DIR}/src
    ${COMMONAPI_CORE_DIR}
    ${COMMONAPI_SOMEIP_DIR}
    ${COMMONAPI_INCLUDE_DIRS}
    ${COMMONAPI_SOMEIP_INCLUDE_DIRS}
    ${VSOMEIP_INCLUDE_DIRS}
)

# Source files
set(SOURCES
    ${CMAKE_SOURCE_DIR}/src/main_mock.cpp
    ${CMAKE_SOURCE_DIR}/src/VehicleControlStubImpl.cpp
)

# CommonAPI generated sources
file(GLOB COMMONAPI_SOMEIP_SOURCES
    "${COMMONAPI_SOMEIP_DIR}/v1/vehiclecontrol/VehicleControlSomeIPStubAdapter.cpp"
    "${COMMONAPI_SOMEIP_DIR}/v1/vehiclecontrol/VehicleControlSomeIPDeployment.cpp"
)

add_executable(VehicleControlECU_Mock
    ${SOURCES}
    ${COMMONAPI_SOMEIP_SOURCES}
)

target_link_libraries(VehicleControlECU_Mock
    Qt5::Core
    CommonAPI
    CommonAPI-SomeIP
    vsomeip3
)
